<!DOCTYPE html>
<html lang="en">

<head>
  <title>Material Calculator</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap" rel="stylesheet" />
  <!-- Using Material Design Bootstrap -->
  <!-- Instead of regular bootstrap -->

  <link href="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/3.6.0/mdb.min.css" rel="stylesheet" />
  <style>
    html {
      font-size: 62.5%;
      box-sizing: border-box;
    }

    *,
    *::before,
    *::after {
      margin: 0;
      padding: 0;
      box-sizing: inherit;
    }

    .calculator {
      border: 1px solid #ccc;
      border-radius: 5px;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 400px;
    }

    .calculator-history {
      width: 100%;
      height: 50px;
      border: none;
      background-color: #252525;
      color: rgb(240, 240, 240);
      text-align: right;
      padding-right: 20px;
      padding-left: 10px;
      font-size: 2rem;
    }

    .calculator-result {
      width: 100%;
      height: 50px;
      border: none;
      background-color: #252525;
      color: #fff;
      text-align: right;
      padding-right: 20px;
      padding-left: 10px;
      font-size: 4rem;
    }

    button {
      height: 60px;
      font-size: 2rem !important;
    }

    .equal-sign {
      height: 98%;
      grid-area: 2 / 4 / 6 / 5;
    }

    .calculator-keys {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      grid-gap: 20px;
      padding: 20px;
    }
  </style>
</head>

<body>
  <div class="calculator card">

    <div class="calculator-history z-depth-1">8x8</div>
    <div class="calculator-result z-depth-1">64</div>

    <div class="calculator-keys">

      <button type="button" id="+" class="operator btn btn-info">+</button>
      <button type="button" id="-" class="operator btn btn-info">-</button>
      <button type="button" id="*" class="operator btn btn-info">&times;</button>
      <button type="button" id="/" class="operator btn btn-info">&divide;</button>

      <button type="button" id="7" class="number btn btn-light waves-effect">7</button>
      <button type="button" id="8" class="number btn btn-light waves-effect">8</button>
      <button type="button" id="9" class="number btn btn-light waves-effect">9</button>


      <button type="button" id="4" class="number btn btn-light waves-effect">4</button>
      <button type="button" id="5" class="number btn btn-light waves-effect">5</button>
      <button type="button" id="6" class="number btn btn-light waves-effect">6</button>


      <button type="button" id="1" class="number btn btn-light waves-effect">1</button>
      <button type="button" id="2" class="number btn btn-light waves-effect">2</button>
      <button type="button" id="3" class="number btn btn-light waves-effect">3</button>

      <button type="button" id="0" class="number btn btn-light waves-effect">0</button>

      <button type="button" id="CE" class="backspace function btn btn-secondary">CE</button>
      <button type="button" id="C" class="clear function btn btn-danger btn-sm">C</button>
      <button type="button" id="=" class="equal-sign operator btn-success btn">=</button>

    </div>
  </div>

</body>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/3.6.0/mdb.min.js"></script>
<script>

  class Calculator {
    constructor() { }
    static obj = new Calculator();

    setHistory(expression) {
      document.getElementsByClassName("calculator-history")[0].innerHTML = expression;
    }

    setResult(result) {
      if (result == "") {
        document.getElementsByClassName("calculator-result")[0].innerHTML = result;
      }
      else {
        document.getElementsByClassName("calculator-result")[0].innerHTML = obj.getFormattedNumber(result);
      }
    }

    getHistory() {
      return document.getElementsByClassName("calculator-history")[0].innerHTML;
    }

    getResult() {
      return document.getElementsByClassName("calculator-result")[0].innerHTML;
    }

    getFormattedNumber(num) {
      if (num == "-") {
        return "";
      }
      var n = Number(num);
      return n.toLocaleString("en");
    }

    reverseNumberFormat(num) {
      return Number(num.replace(/,/g, ''));
    }
    functionListenerEvents() {
      const functions = document.getElementsByClassName("function");
      for (let i = 0; i < functions.length; i++) {
        functions[i].addEventListener('click', function () {
          if (this.id == "C") {
            obj.setHistory("");
            obj.setResult("");
          }
          else if (this.id == "CE") {
            var output = obj.reverseNumberFormat(obj.getResult()).toString();
            if (output) {
              output = output.substr(0, output.length - 1);
              obj.setResult(output);
            }
          }
        });
      }
    }

    operatorListenerEvents() {
      const operator = document.getElementsByClassName("operator");
      for (let i = 0; i < operator.length; i++) {
        operator[i].addEventListener('click', function () {
          var output = obj.getResult();
          var history = obj.getHistory();
          if (output == "" && history != "") {
            if (isNaN(history[history.length - 1])) {
              history = history.substr(0, history.length - 1);
            }
          }
          if (output != "" || history != "") {
            output = output == "" ? output : obj.reverseNumberFormat(output);
            history += output;
            if (this.id == "=") {
              var result = eval(history);
              obj.setResult(result);
              obj.setHistory("");
            }
            else {
              history += this.id;
              obj.setResult("");
              obj.setHistory(history);
            }
          }
        });
      }
    }

    numberListenerEvents() {
      const number = document.getElementsByClassName("number");
      for (let i = 0; i < number.length; i++) {
        number[i].addEventListener('click', function () {
          var output = obj.reverseNumberFormat(obj.getResult());
          if (output != NaN) {
            output += this.id;
            obj.setResult(output);
          }
        });
      }
    }

  }

  var obj = new Calculator();
  obj.numberListenerEvents();
  obj.operatorListenerEvents();
  obj.functionListenerEvents();

</script>

</html>